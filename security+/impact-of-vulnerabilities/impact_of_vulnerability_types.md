# Impact of Vulnerability Types

## Exam Requirements
* W.r.t vulnerabilities, must understand:
    * Sources
    * Types
    * Impacts associated

## Definition
* Vulnerability is specific characteristic or flaw of a system which could be expoloited by an attacker
* Source of almost all security concerns

## List of Vulnerabilities Types

### Race Conditions
#### Description
* Type of error condition
    * Occurs when outputs dependent on type/timing of inputs...
    * ...and input does not happen as expected
* Multiple inputs 'racing' to influence output

#### Impact
* Most common: crash
* Or generally malformed 

#### Countermeasures
* Reference counter: structure in kernel indicating when resource is in use
    * Other inputs know not to access it when in use
* Lock kernel: Makes section of kernel innacessible until any other process finished on it
    * Downside: Performance degradation
* Best solution: Thread synchronisation
    * Calls to kernel are queued and execute synchronously

### End-of-Life Systems
#### Description
* System no longer supported by vendor
    * New vulnerabilities are not monitored/patched

#### Impact
* Every weakness that appears in system after EOL is permanent and exploitable
    * To maintain security, external controls are required

### Lack of Vendor Support
#### Description
* Vendor is not supplying support agreement for some reason
    * Usually happens when purchasing through third party

#### Impact
* Exactly the same as EOL systems

### Embedded Systems
#### Description
* Definition: systems inside other systems performing particular function
* Issue: these often fall outside scope of patching

#### Impact
* Vulnerabilities are exposed and go unnoticed

### Input Validation/Improper input handling
#### Description
* Top cause of software vulnerabilities
* Manipulated input is not sanitised, and can influence unexpected results from programme
* Attacks which take advantage of this vulnerability type:
    * Buffer overflow
    * Cross-site scripting
    * Cross-site request forgery
    * Injection attacks

#### Impact
* Malicious input can execute arbitrary commands as application
    * Gives attacker access to application privilege level

#### Countermeasures
* Proper input vallidation for all input fields

### Improper error handling
#### Description
* Application is forced into state of error handling
* While reporting on error conditions, returns information advantageous to attacker
    * E.g. SQL error messages could disclose structure of a table
    * E.g. RPC errors returning file/host names or directory structures

#### Countermeasures
* Use standardised error messages
* Write error information to log file
    * Secure log file with access control

### Configuration Issues
#### Description
* Several types
* Application misconfiguration: Proper configuration or security controls are not put in place by administrator
    * Happens when administrator is rushed/doesn't understand 
* Application default configuration: Security controls may not have been tightened yet
* User account misconfiguration: user is incorrectly configured
    * Often happens when not permissioning using groups

#### Impact
* Attacker can assume privileges of the misconfigured user account or application
* Especially dangerous on routers which can expose a lot of information

#### Mitigations
* Careful management of security controls
    * E.g. highly securing local admin/root passwords

### Memory and Buffer Vulnerabilities
#### Description
* Vulnerabilities taking advantage of data written into memory
    * Memory leak: sensitive data not effectively cleared from memory after execution
    * Integer overflow: logic error when integer bigger than reserved memory space is written
    * Buffer overflow: input buffer is overwritten with excess data, causing unexpected behaviour

#### Countermeasures
* Pointer dereference
    * Using values in a memory location pointed to by an address in another location

### DLL Injection
#### Description
* DLLs are added to programs to exploit vulnerabilities or execute malicious code

### Resource Exhaustion
#### Description
* System doesn't have required resources for correct operation

#### Impact
* Similar to race conditions
    * Crashes
    * Degraded performance

### Untrainer Users
#### Description
* Extremely common
* Users are not trained properly via correct policy and procedure
    * Subsequently bypassing controls

#### Impact
* Weakened security posture of system which attackers can exploit

#### Countermeasures
* Education
* Policy
* Standards

### Vulnerable Business Processes
#### Description
* Weaknesses in how business does things exposes weaknesses for attackers to exploit
    * E.g. if business pays invoices straight away without checking services were actually delivered...
    * ... attackers might send invoices and recieve payment without delivering any service
* Automation on top of these magnifies vulnerability

#### Countermeasures
* Documented processes
* Education
* Policy

### Weak Implementations
#### Description
* Weaknesses in encryption algorithms leaves opportunity for attacker to decrypt senisitve data

#### Countermeasures
* User proven vetted cryptographic library

### Documentation-related vulnerabilities
#### Description
* Weaknesses from lack of common understanding of system
    * System Sprawl - system expands and new parts not documented
    * Undocumented assets - security controls are forgotten on assets which are not properly monitored

#### Coutnermeasures
* Constant documentation
* Understandable documentation

### Architecture and Design Weaknesses
#### Desription
* Vulnerabilities based on system design
    * E.g. flat network with no segmentation

#### Impact
* Easy access and lateral movement for attacker

#### Countermeasures
* Redesign of system/network
    * Difficult to correct, as redesign is costly

### New Threats & Zero Days
#### Description
* Vulnerabilities previously undiscovered with no direct mitigation available

#### Countermeasures
* Compensating controls

### Improper Certificate and Key Management
#### Description
* Authentication systems not managed properly
    * E.g. expired assets still being usable

#### Impact
* Easier authentication for attacker

#### Countermeasures
* Correct certificate and key management